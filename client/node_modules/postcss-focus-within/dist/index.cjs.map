{"version":3,"file":"index.cjs","sources":["../src/index.ts"],"sourcesContent":["import parser from 'postcss-selector-parser';\nimport type { PluginCreator } from 'postcss';\n\nconst creator: PluginCreator<{ preserve?: boolean, replaceWith?: string }> = (opts?: { preserve?: boolean, replaceWith?: string }) => {\n\tconst replaceWith = String(Object(opts).replaceWith || '[focus-within]');\n\tconst preserve = Boolean('preserve' in Object(opts) ? opts.preserve : true);\n\tconst replacementAST = parser().astSync(replaceWith);\n\n\treturn {\n\t\tpostcssPlugin: 'postcss-focus-within',\n\t\tRule: (rule, { result })=> {\n\t\t\tif (!rule.selector.includes(':focus-within')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet modifiedSelector;\n\n\t\t\ttry {\n\t\t\t\tconst modifiedSelectorAST = parser((selectors) => {\n\t\t\t\t\tselectors.walkPseudos((pseudo) => {\n\t\t\t\t\t\tif (pseudo.value !== ':focus-within') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (pseudo.nodes && pseudo.nodes.length) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpseudo.replaceWith(replacementAST.clone({}));\n\t\t\t\t\t});\n\t\t\t\t}).processSync(rule.selector);\n\n\t\t\t\tmodifiedSelector = String(modifiedSelectorAST);\n\t\t\t} catch (_) {\n\t\t\t\trule.warn(result, `Failed to parse selector : ${rule.selector}`);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (typeof modifiedSelector === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (modifiedSelector === rule.selector) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst clone = rule.clone({ selector: modifiedSelector });\n\n\t\t\tif (preserve) {\n\t\t\t\trule.before(clone);\n\t\t\t} else {\n\t\t\t\trule.replaceWith(clone);\n\t\t\t}\n\t\t},\n\t};\n};\n\ncreator.postcss = true;\n\nexport default creator;\n\n"],"names":["creator","opts","replaceWith","String","Object","preserve","Boolean","replacementAST","parser","astSync","postcssPlugin","Rule","rule","result","selector","includes","modifiedSelector","modifiedSelectorAST","selectors","walkPseudos","pseudo","value","nodes","length","clone","processSync","_","warn","before","postcss"],"mappings":"uIAGMA,EAAwEC,IAC7E,MAAMC,EAAcC,OAAOC,OAAOH,GAAMC,aAAe,kBACjDG,EAAWC,UAAQ,aAAcF,OAAOH,KAAQA,EAAKI,UACrDE,EAAiBC,YAASC,QAAQP,GAExC,MAAO,CACNQ,cAAe,uBACfC,KAAM,CAACC,GAAQC,OAAAA,MACd,IAAKD,EAAKE,SAASC,SAAS,iBAC3B,OAGD,IAAIC,EAEJ,IACC,MAAMC,EAAsBT,WAAQU,IACnCA,EAAUC,aAAaC,IACD,kBAAjBA,EAAOC,QAIPD,EAAOE,OAASF,EAAOE,MAAMC,QAIjCH,EAAOlB,YAAYK,EAAeiB,MAAM,YAEvCC,YAAYb,EAAKE,UAEpBE,EAAmBb,OAAOc,GACzB,MAAOS,GAER,YADAd,EAAKe,KAAKd,EAAQ,8BAA8BD,EAAKE,YAItD,QAAgC,IAArBE,EACV,OAGD,GAAIA,IAAqBJ,EAAKE,SAC7B,OAGD,MAAMU,EAAQZ,EAAKY,MAAM,CAAEV,SAAUE,IAEjCX,EACHO,EAAKgB,OAAOJ,GAEZZ,EAAKV,YAAYsB,MAMrBxB,EAAQ6B,SAAU"}