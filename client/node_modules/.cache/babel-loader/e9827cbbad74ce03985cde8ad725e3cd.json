{"ast":null,"code":"var parseKeys = require('parse-asn1');\nvar mgf = require('./mgf');\nvar xor = require('./xor');\nvar BN = require('bn.js');\nvar crt = require('browserify-rsa');\nvar createHash = require('create-hash');\nvar withPublic = require('./withPublic');\nvar Buffer = require('safe-buffer').Buffer;\nmodule.exports = function privateDecrypt(privateKey, enc, reverse) {\n  var padding;\n  if (privateKey.padding) {\n    padding = privateKey.padding;\n  } else if (reverse) {\n    padding = 1;\n  } else {\n    padding = 4;\n  }\n  var key = parseKeys(privateKey);\n  var k = key.modulus.byteLength();\n  if (enc.length > k || new BN(enc).cmp(key.modulus) >= 0) {\n    throw new Error('decryption error');\n  }\n  var msg;\n  if (reverse) {\n    msg = withPublic(new BN(enc), key);\n  } else {\n    msg = crt(enc, key);\n  }\n  var zBuffer = Buffer.alloc(k - msg.length);\n  msg = Buffer.concat([zBuffer, msg], k);\n  if (padding === 4) {\n    return oaep(key, msg);\n  } else if (padding === 1) {\n    return pkcs1(key, msg, reverse);\n  } else if (padding === 3) {\n    return msg;\n  } else {\n    throw new Error('unknown padding');\n  }\n};\nfunction oaep(key, msg) {\n  var k = key.modulus.byteLength();\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest();\n  var hLen = iHash.length;\n  if (msg[0] !== 0) {\n    throw new Error('decryption error');\n  }\n  var maskedSeed = msg.slice(1, hLen + 1);\n  var maskedDb = msg.slice(hLen + 1);\n  var seed = xor(maskedSeed, mgf(maskedDb, hLen));\n  var db = xor(maskedDb, mgf(seed, k - hLen - 1));\n  if (compare(iHash, db.slice(0, hLen))) {\n    throw new Error('decryption error');\n  }\n  var i = hLen;\n  while (db[i] === 0) {\n    i++;\n  }\n  if (db[i++] !== 1) {\n    throw new Error('decryption error');\n  }\n  return db.slice(i);\n}\nfunction pkcs1(key, msg, reverse) {\n  var p1 = msg.slice(0, 2);\n  var i = 2;\n  var status = 0;\n  while (msg[i++] !== 0) {\n    if (i >= msg.length) {\n      status++;\n      break;\n    }\n  }\n  var ps = msg.slice(2, i - 1);\n  if (p1.toString('hex') !== '0002' && !reverse || p1.toString('hex') !== '0001' && reverse) {\n    status++;\n  }\n  if (ps.length < 8) {\n    status++;\n  }\n  if (status) {\n    throw new Error('decryption error');\n  }\n  return msg.slice(i);\n}\nfunction compare(a, b) {\n  a = Buffer.from(a);\n  b = Buffer.from(b);\n  var dif = 0;\n  var len = a.length;\n  if (a.length !== b.length) {\n    dif++;\n    len = Math.min(a.length, b.length);\n  }\n  var i = -1;\n  while (++i < len) {\n    dif += a[i] ^ b[i];\n  }\n  return dif;\n}","map":{"version":3,"names":["parseKeys","require","mgf","xor","BN","crt","createHash","withPublic","Buffer","module","exports","privateDecrypt","privateKey","enc","reverse","padding","key","k","modulus","byteLength","length","cmp","Error","msg","zBuffer","alloc","concat","oaep","pkcs1","iHash","update","digest","hLen","maskedSeed","slice","maskedDb","seed","db","compare","i","p1","status","ps","toString","a","b","from","dif","len","Math","min"],"sources":["/Users/admin/Desktop/Newsletter-Signup/Full-Stack-Project-Assessment/client/node_modules/public-encrypt/privateDecrypt.js"],"sourcesContent":["var parseKeys = require('parse-asn1')\nvar mgf = require('./mgf')\nvar xor = require('./xor')\nvar BN = require('bn.js')\nvar crt = require('browserify-rsa')\nvar createHash = require('create-hash')\nvar withPublic = require('./withPublic')\nvar Buffer = require('safe-buffer').Buffer\n\nmodule.exports = function privateDecrypt (privateKey, enc, reverse) {\n  var padding\n  if (privateKey.padding) {\n    padding = privateKey.padding\n  } else if (reverse) {\n    padding = 1\n  } else {\n    padding = 4\n  }\n\n  var key = parseKeys(privateKey)\n  var k = key.modulus.byteLength()\n  if (enc.length > k || new BN(enc).cmp(key.modulus) >= 0) {\n    throw new Error('decryption error')\n  }\n  var msg\n  if (reverse) {\n    msg = withPublic(new BN(enc), key)\n  } else {\n    msg = crt(enc, key)\n  }\n  var zBuffer = Buffer.alloc(k - msg.length)\n  msg = Buffer.concat([zBuffer, msg], k)\n  if (padding === 4) {\n    return oaep(key, msg)\n  } else if (padding === 1) {\n    return pkcs1(key, msg, reverse)\n  } else if (padding === 3) {\n    return msg\n  } else {\n    throw new Error('unknown padding')\n  }\n}\n\nfunction oaep (key, msg) {\n  var k = key.modulus.byteLength()\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest()\n  var hLen = iHash.length\n  if (msg[0] !== 0) {\n    throw new Error('decryption error')\n  }\n  var maskedSeed = msg.slice(1, hLen + 1)\n  var maskedDb = msg.slice(hLen + 1)\n  var seed = xor(maskedSeed, mgf(maskedDb, hLen))\n  var db = xor(maskedDb, mgf(seed, k - hLen - 1))\n  if (compare(iHash, db.slice(0, hLen))) {\n    throw new Error('decryption error')\n  }\n  var i = hLen\n  while (db[i] === 0) {\n    i++\n  }\n  if (db[i++] !== 1) {\n    throw new Error('decryption error')\n  }\n  return db.slice(i)\n}\n\nfunction pkcs1 (key, msg, reverse) {\n  var p1 = msg.slice(0, 2)\n  var i = 2\n  var status = 0\n  while (msg[i++] !== 0) {\n    if (i >= msg.length) {\n      status++\n      break\n    }\n  }\n  var ps = msg.slice(2, i - 1)\n\n  if ((p1.toString('hex') !== '0002' && !reverse) || (p1.toString('hex') !== '0001' && reverse)) {\n    status++\n  }\n  if (ps.length < 8) {\n    status++\n  }\n  if (status) {\n    throw new Error('decryption error')\n  }\n  return msg.slice(i)\n}\nfunction compare (a, b) {\n  a = Buffer.from(a)\n  b = Buffer.from(b)\n  var dif = 0\n  var len = a.length\n  if (a.length !== b.length) {\n    dif++\n    len = Math.min(a.length, b.length)\n  }\n  var i = -1\n  while (++i < len) {\n    dif += (a[i] ^ b[i])\n  }\n  return dif\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}