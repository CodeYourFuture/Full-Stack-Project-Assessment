{"ast":null,"code":"var aes = require('./aes');\nvar Buffer = require('safe-buffer').Buffer;\nvar Transform = require('cipher-base');\nvar inherits = require('inherits');\nvar GHASH = require('./ghash');\nvar xor = require('buffer-xor');\nvar incr32 = require('./incr32');\nfunction xorTest(a, b) {\n  var out = 0;\n  if (a.length !== b.length) out++;\n  var len = Math.min(a.length, b.length);\n  for (var i = 0; i < len; ++i) {\n    out += a[i] ^ b[i];\n  }\n  return out;\n}\nfunction calcIv(self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])]);\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])]);\n  }\n  var ghash = new GHASH(ck);\n  var len = iv.length;\n  var toPad = len % 16;\n  ghash.update(iv);\n  if (toPad) {\n    toPad = 16 - toPad;\n    ghash.update(Buffer.alloc(toPad, 0));\n  }\n  ghash.update(Buffer.alloc(8, 0));\n  var ivBits = len * 8;\n  var tail = Buffer.alloc(8);\n  tail.writeUIntBE(ivBits, 0, 8);\n  ghash.update(tail);\n  self._finID = ghash.state;\n  var out = Buffer.from(self._finID);\n  incr32(out);\n  return out;\n}\nfunction StreamCipher(mode, key, iv, decrypt) {\n  Transform.call(this);\n  var h = Buffer.alloc(4, 0);\n  this._cipher = new aes.AES(key);\n  var ck = this._cipher.encryptBlock(h);\n  this._ghash = new GHASH(ck);\n  iv = calcIv(this, iv, ck);\n  this._prev = Buffer.from(iv);\n  this._cache = Buffer.allocUnsafe(0);\n  this._secCache = Buffer.allocUnsafe(0);\n  this._decrypt = decrypt;\n  this._alen = 0;\n  this._len = 0;\n  this._mode = mode;\n  this._authTag = null;\n  this._called = false;\n}\ninherits(StreamCipher, Transform);\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - this._alen % 16;\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0);\n      this._ghash.update(rump);\n    }\n  }\n  this._called = true;\n  var out = this._mode.encrypt(this, chunk);\n  if (this._decrypt) {\n    this._ghash.update(chunk);\n  } else {\n    this._ghash.update(out);\n  }\n  this._len += chunk.length;\n  return out;\n};\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data');\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID));\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data');\n  this._authTag = tag;\n  this._cipher.scrub();\n};\nStreamCipher.prototype.getAuthTag = function getAuthTag() {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state');\n  return this._authTag;\n};\nStreamCipher.prototype.setAuthTag = function setAuthTag(tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state');\n  this._authTag = tag;\n};\nStreamCipher.prototype.setAAD = function setAAD(buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state');\n  this._ghash.update(buf);\n  this._alen += buf.length;\n};\nmodule.exports = StreamCipher;","map":{"version":3,"names":["aes","require","Buffer","Transform","inherits","GHASH","xor","incr32","xorTest","a","b","out","length","len","Math","min","i","calcIv","self","iv","ck","_finID","concat","from","ghash","toPad","update","alloc","ivBits","tail","writeUIntBE","state","StreamCipher","mode","key","decrypt","call","h","_cipher","AES","encryptBlock","_ghash","_prev","_cache","allocUnsafe","_secCache","_decrypt","_alen","_len","_mode","_authTag","_called","prototype","_update","chunk","rump","encrypt","_final","Error","tag","final","scrub","getAuthTag","isBuffer","setAuthTag","setAAD","buf","module","exports"],"sources":["/Users/admin/Desktop/Newsletter-Signup/Full-Stack-Project-Assessment/client/node_modules/browserify-aes/authCipher.js"],"sourcesContent":["var aes = require('./aes')\nvar Buffer = require('safe-buffer').Buffer\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\nvar incr32 = require('./incr32')\n\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) out++\n\n  var len = Math.min(a.length, b.length)\n  for (var i = 0; i < len; ++i) {\n    out += (a[i] ^ b[i])\n  }\n\n  return out\n}\n\nfunction calcIv (self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])])\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])])\n  }\n  var ghash = new GHASH(ck)\n  var len = iv.length\n  var toPad = len % 16\n  ghash.update(iv)\n  if (toPad) {\n    toPad = 16 - toPad\n    ghash.update(Buffer.alloc(toPad, 0))\n  }\n  ghash.update(Buffer.alloc(8, 0))\n  var ivBits = len * 8\n  var tail = Buffer.alloc(8)\n  tail.writeUIntBE(ivBits, 0, 8)\n  ghash.update(tail)\n  self._finID = ghash.state\n  var out = Buffer.from(self._finID)\n  incr32(out)\n  return out\n}\nfunction StreamCipher (mode, key, iv, decrypt) {\n  Transform.call(this)\n\n  var h = Buffer.alloc(4, 0)\n\n  this._cipher = new aes.AES(key)\n  var ck = this._cipher.encryptBlock(h)\n  this._ghash = new GHASH(ck)\n  iv = calcIv(this, iv, ck)\n\n  this._prev = Buffer.from(iv)\n  this._cache = Buffer.allocUnsafe(0)\n  this._secCache = Buffer.allocUnsafe(0)\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  this._mode = mode\n\n  this._authTag = null\n  this._called = false\n}\n\ninherits(StreamCipher, Transform)\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0)\n      this._ghash.update(rump)\n    }\n  }\n\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data')\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data')\n\n  this._authTag = tag\n  this._cipher.scrub()\n}\n\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state')\n\n  return this._authTag\n}\n\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state')\n\n  this._authTag = tag\n}\n\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state')\n\n  this._ghash.update(buf)\n  this._alen += buf.length\n}\n\nmodule.exports = StreamCipher\n"],"mappings":"AAAA,IAAIA,GAAG,GAAGC,OAAO,CAAC,OAAO,CAAC;AAC1B,IAAIC,MAAM,GAAGD,OAAO,CAAC,aAAa,CAAC,CAACC,MAAM;AAC1C,IAAIC,SAAS,GAAGF,OAAO,CAAC,aAAa,CAAC;AACtC,IAAIG,QAAQ,GAAGH,OAAO,CAAC,UAAU,CAAC;AAClC,IAAII,KAAK,GAAGJ,OAAO,CAAC,SAAS,CAAC;AAC9B,IAAIK,GAAG,GAAGL,OAAO,CAAC,YAAY,CAAC;AAC/B,IAAIM,MAAM,GAAGN,OAAO,CAAC,UAAU,CAAC;AAEhC,SAASO,OAAOA,CAAEC,CAAC,EAAEC,CAAC,EAAE;EACtB,IAAIC,GAAG,GAAG,CAAC;EACX,IAAIF,CAAC,CAACG,MAAM,KAAKF,CAAC,CAACE,MAAM,EAAED,GAAG,EAAE;EAEhC,IAAIE,GAAG,GAAGC,IAAI,CAACC,GAAG,CAACN,CAAC,CAACG,MAAM,EAAEF,CAAC,CAACE,MAAM,CAAC;EACtC,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,GAAG,EAAE,EAAEG,CAAC,EAAE;IAC5BL,GAAG,IAAKF,CAAC,CAACO,CAAC,CAAC,GAAGN,CAAC,CAACM,CAAC,CAAE;EACtB;EAEA,OAAOL,GAAG;AACZ;AAEA,SAASM,MAAMA,CAAEC,IAAI,EAAEC,EAAE,EAAEC,EAAE,EAAE;EAC7B,IAAID,EAAE,CAACP,MAAM,KAAK,EAAE,EAAE;IACpBM,IAAI,CAACG,MAAM,GAAGnB,MAAM,CAACoB,MAAM,CAAC,CAACH,EAAE,EAAEjB,MAAM,CAACqB,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAC5D,OAAOrB,MAAM,CAACoB,MAAM,CAAC,CAACH,EAAE,EAAEjB,MAAM,CAACqB,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACvD;EACA,IAAIC,KAAK,GAAG,IAAInB,KAAK,CAACe,EAAE,CAAC;EACzB,IAAIP,GAAG,GAAGM,EAAE,CAACP,MAAM;EACnB,IAAIa,KAAK,GAAGZ,GAAG,GAAG,EAAE;EACpBW,KAAK,CAACE,MAAM,CAACP,EAAE,CAAC;EAChB,IAAIM,KAAK,EAAE;IACTA,KAAK,GAAG,EAAE,GAAGA,KAAK;IAClBD,KAAK,CAACE,MAAM,CAACxB,MAAM,CAACyB,KAAK,CAACF,KAAK,EAAE,CAAC,CAAC,CAAC;EACtC;EACAD,KAAK,CAACE,MAAM,CAACxB,MAAM,CAACyB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAChC,IAAIC,MAAM,GAAGf,GAAG,GAAG,CAAC;EACpB,IAAIgB,IAAI,GAAG3B,MAAM,CAACyB,KAAK,CAAC,CAAC,CAAC;EAC1BE,IAAI,CAACC,WAAW,CAACF,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;EAC9BJ,KAAK,CAACE,MAAM,CAACG,IAAI,CAAC;EAClBX,IAAI,CAACG,MAAM,GAAGG,KAAK,CAACO,KAAK;EACzB,IAAIpB,GAAG,GAAGT,MAAM,CAACqB,IAAI,CAACL,IAAI,CAACG,MAAM,CAAC;EAClCd,MAAM,CAACI,GAAG,CAAC;EACX,OAAOA,GAAG;AACZ;AACA,SAASqB,YAAYA,CAAEC,IAAI,EAAEC,GAAG,EAAEf,EAAE,EAAEgB,OAAO,EAAE;EAC7ChC,SAAS,CAACiC,IAAI,CAAC,IAAI,CAAC;EAEpB,IAAIC,CAAC,GAAGnC,MAAM,CAACyB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EAE1B,IAAI,CAACW,OAAO,GAAG,IAAItC,GAAG,CAACuC,GAAG,CAACL,GAAG,CAAC;EAC/B,IAAId,EAAE,GAAG,IAAI,CAACkB,OAAO,CAACE,YAAY,CAACH,CAAC,CAAC;EACrC,IAAI,CAACI,MAAM,GAAG,IAAIpC,KAAK,CAACe,EAAE,CAAC;EAC3BD,EAAE,GAAGF,MAAM,CAAC,IAAI,EAAEE,EAAE,EAAEC,EAAE,CAAC;EAEzB,IAAI,CAACsB,KAAK,GAAGxC,MAAM,CAACqB,IAAI,CAACJ,EAAE,CAAC;EAC5B,IAAI,CAACwB,MAAM,GAAGzC,MAAM,CAAC0C,WAAW,CAAC,CAAC,CAAC;EACnC,IAAI,CAACC,SAAS,GAAG3C,MAAM,CAAC0C,WAAW,CAAC,CAAC,CAAC;EACtC,IAAI,CAACE,QAAQ,GAAGX,OAAO;EACvB,IAAI,CAACY,KAAK,GAAG,CAAC;EACd,IAAI,CAACC,IAAI,GAAG,CAAC;EACb,IAAI,CAACC,KAAK,GAAGhB,IAAI;EAEjB,IAAI,CAACiB,QAAQ,GAAG,IAAI;EACpB,IAAI,CAACC,OAAO,GAAG,KAAK;AACtB;AAEA/C,QAAQ,CAAC4B,YAAY,EAAE7B,SAAS,CAAC;AAEjC6B,YAAY,CAACoB,SAAS,CAACC,OAAO,GAAG,UAAUC,KAAK,EAAE;EAChD,IAAI,CAAC,IAAI,CAACH,OAAO,IAAI,IAAI,CAACJ,KAAK,EAAE;IAC/B,IAAIQ,IAAI,GAAG,EAAE,GAAI,IAAI,CAACR,KAAK,GAAG,EAAG;IACjC,IAAIQ,IAAI,GAAG,EAAE,EAAE;MACbA,IAAI,GAAGrD,MAAM,CAACyB,KAAK,CAAC4B,IAAI,EAAE,CAAC,CAAC;MAC5B,IAAI,CAACd,MAAM,CAACf,MAAM,CAAC6B,IAAI,CAAC;IAC1B;EACF;EAEA,IAAI,CAACJ,OAAO,GAAG,IAAI;EACnB,IAAIxC,GAAG,GAAG,IAAI,CAACsC,KAAK,CAACO,OAAO,CAAC,IAAI,EAAEF,KAAK,CAAC;EACzC,IAAI,IAAI,CAACR,QAAQ,EAAE;IACjB,IAAI,CAACL,MAAM,CAACf,MAAM,CAAC4B,KAAK,CAAC;EAC3B,CAAC,MAAM;IACL,IAAI,CAACb,MAAM,CAACf,MAAM,CAACf,GAAG,CAAC;EACzB;EACA,IAAI,CAACqC,IAAI,IAAIM,KAAK,CAAC1C,MAAM;EACzB,OAAOD,GAAG;AACZ,CAAC;AAEDqB,YAAY,CAACoB,SAAS,CAACK,MAAM,GAAG,YAAY;EAC1C,IAAI,IAAI,CAACX,QAAQ,IAAI,CAAC,IAAI,CAACI,QAAQ,EAAE,MAAM,IAAIQ,KAAK,CAAC,kDAAkD,CAAC;EAExG,IAAIC,GAAG,GAAGrD,GAAG,CAAC,IAAI,CAACmC,MAAM,CAACmB,KAAK,CAAC,IAAI,CAACb,KAAK,GAAG,CAAC,EAAE,IAAI,CAACC,IAAI,GAAG,CAAC,CAAC,EAAE,IAAI,CAACV,OAAO,CAACE,YAAY,CAAC,IAAI,CAACnB,MAAM,CAAC,CAAC;EACvG,IAAI,IAAI,CAACyB,QAAQ,IAAItC,OAAO,CAACmD,GAAG,EAAE,IAAI,CAACT,QAAQ,CAAC,EAAE,MAAM,IAAIQ,KAAK,CAAC,kDAAkD,CAAC;EAErH,IAAI,CAACR,QAAQ,GAAGS,GAAG;EACnB,IAAI,CAACrB,OAAO,CAACuB,KAAK,EAAE;AACtB,CAAC;AAED7B,YAAY,CAACoB,SAAS,CAACU,UAAU,GAAG,SAASA,UAAUA,CAAA,EAAI;EACzD,IAAI,IAAI,CAAChB,QAAQ,IAAI,CAAC5C,MAAM,CAAC6D,QAAQ,CAAC,IAAI,CAACb,QAAQ,CAAC,EAAE,MAAM,IAAIQ,KAAK,CAAC,iDAAiD,CAAC;EAExH,OAAO,IAAI,CAACR,QAAQ;AACtB,CAAC;AAEDlB,YAAY,CAACoB,SAAS,CAACY,UAAU,GAAG,SAASA,UAAUA,CAAEL,GAAG,EAAE;EAC5D,IAAI,CAAC,IAAI,CAACb,QAAQ,EAAE,MAAM,IAAIY,KAAK,CAAC,iDAAiD,CAAC;EAEtF,IAAI,CAACR,QAAQ,GAAGS,GAAG;AACrB,CAAC;AAED3B,YAAY,CAACoB,SAAS,CAACa,MAAM,GAAG,SAASA,MAAMA,CAAEC,GAAG,EAAE;EACpD,IAAI,IAAI,CAACf,OAAO,EAAE,MAAM,IAAIO,KAAK,CAAC,4CAA4C,CAAC;EAE/E,IAAI,CAACjB,MAAM,CAACf,MAAM,CAACwC,GAAG,CAAC;EACvB,IAAI,CAACnB,KAAK,IAAImB,GAAG,CAACtD,MAAM;AAC1B,CAAC;AAEDuD,MAAM,CAACC,OAAO,GAAGpC,YAAY"},"metadata":{},"sourceType":"script"}