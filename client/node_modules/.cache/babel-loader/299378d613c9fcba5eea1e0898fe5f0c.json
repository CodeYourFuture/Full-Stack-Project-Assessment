{"ast":null,"code":"var BN = require('bn.js');\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar TWENTYFOUR = new BN(24);\nvar ELEVEN = new BN(11);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar primes = require('./generatePrime');\nvar randomBytes = require('randombytes');\nmodule.exports = DH;\nfunction setPublicKey(pub, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc);\n  }\n  this._pub = new BN(pub);\n  return this;\n}\nfunction setPrivateKey(priv, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc);\n  }\n  this._priv = new BN(priv);\n  return this;\n}\nvar primeCache = {};\nfunction checkPrime(prime, generator) {\n  var gen = generator.toString('hex');\n  var hex = [gen, prime.toString(16)].join('_');\n  if (hex in primeCache) {\n    return primeCache[hex];\n  }\n  var error = 0;\n  if (prime.isEven() || !primes.simpleSieve || !primes.fermatTest(prime) || !millerRabin.test(prime)) {\n    //not a prime so +1\n    error += 1;\n    if (gen === '02' || gen === '05') {\n      // we'd be able to check the generator\n      // it would fail so +8\n      error += 8;\n    } else {\n      //we wouldn't be able to test the generator\n      // so +4\n      error += 4;\n    }\n    primeCache[hex] = error;\n    return error;\n  }\n  if (!millerRabin.test(prime.shrn(1))) {\n    //not a safe prime\n    error += 2;\n  }\n  var rem;\n  switch (gen) {\n    case '02':\n      if (prime.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        // unsuidable generator\n        error += 8;\n      }\n      break;\n    case '05':\n      rem = prime.mod(TEN);\n      if (rem.cmp(THREE) && rem.cmp(SEVEN)) {\n        // prime mod 10 needs to equal 3 or 7\n        error += 8;\n      }\n      break;\n    default:\n      error += 4;\n  }\n  primeCache[hex] = error;\n  return error;\n}\nfunction DH(prime, generator, malleable) {\n  this.setGenerator(generator);\n  this.__prime = new BN(prime);\n  this._prime = BN.mont(this.__prime);\n  this._primeLen = prime.length;\n  this._pub = undefined;\n  this._priv = undefined;\n  this._primeCode = undefined;\n  if (malleable) {\n    this.setPublicKey = setPublicKey;\n    this.setPrivateKey = setPrivateKey;\n  } else {\n    this._primeCode = 8;\n  }\n}\nObject.defineProperty(DH.prototype, 'verifyError', {\n  enumerable: true,\n  get: function () {\n    if (typeof this._primeCode !== 'number') {\n      this._primeCode = checkPrime(this.__prime, this.__gen);\n    }\n    return this._primeCode;\n  }\n});\nDH.prototype.generateKeys = function () {\n  if (!this._priv) {\n    this._priv = new BN(randomBytes(this._primeLen));\n  }\n  this._pub = this._gen.toRed(this._prime).redPow(this._priv).fromRed();\n  return this.getPublicKey();\n};\nDH.prototype.computeSecret = function (other) {\n  other = new BN(other);\n  other = other.toRed(this._prime);\n  var secret = other.redPow(this._priv).fromRed();\n  var out = new Buffer(secret.toArray());\n  var prime = this.getPrime();\n  if (out.length < prime.length) {\n    var front = new Buffer(prime.length - out.length);\n    front.fill(0);\n    out = Buffer.concat([front, out]);\n  }\n  return out;\n};\nDH.prototype.getPublicKey = function getPublicKey(enc) {\n  return formatReturnValue(this._pub, enc);\n};\nDH.prototype.getPrivateKey = function getPrivateKey(enc) {\n  return formatReturnValue(this._priv, enc);\n};\nDH.prototype.getPrime = function (enc) {\n  return formatReturnValue(this.__prime, enc);\n};\nDH.prototype.getGenerator = function (enc) {\n  return formatReturnValue(this._gen, enc);\n};\nDH.prototype.setGenerator = function (gen, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(gen)) {\n    gen = new Buffer(gen, enc);\n  }\n  this.__gen = gen;\n  this._gen = new BN(gen);\n  return this;\n};\nfunction formatReturnValue(bn, enc) {\n  var buf = new Buffer(bn.toArray());\n  if (!enc) {\n    return buf;\n  } else {\n    return buf.toString(enc);\n  }\n}","map":{"version":3,"names":["BN","require","MillerRabin","millerRabin","TWENTYFOUR","ELEVEN","TEN","THREE","SEVEN","primes","randomBytes","module","exports","DH","setPublicKey","pub","enc","Buffer","isBuffer","_pub","setPrivateKey","priv","_priv","primeCache","checkPrime","prime","generator","gen","toString","hex","join","error","isEven","simpleSieve","fermatTest","test","shrn","rem","mod","cmp","malleable","setGenerator","__prime","_prime","mont","_primeLen","length","undefined","_primeCode","Object","defineProperty","prototype","enumerable","get","__gen","generateKeys","_gen","toRed","redPow","fromRed","getPublicKey","computeSecret","other","secret","out","toArray","getPrime","front","fill","concat","formatReturnValue","getPrivateKey","getGenerator","bn","buf"],"sources":["/Users/admin/Desktop/Newsletter-Signup/Full-Stack-Project-Assessment/client/node_modules/diffie-hellman/lib/dh.js"],"sourcesContent":["var BN = require('bn.js');\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar TWENTYFOUR = new BN(24);\nvar ELEVEN = new BN(11);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar primes = require('./generatePrime');\nvar randomBytes = require('randombytes');\nmodule.exports = DH;\n\nfunction setPublicKey(pub, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc);\n  }\n  this._pub = new BN(pub);\n  return this;\n}\n\nfunction setPrivateKey(priv, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc);\n  }\n  this._priv = new BN(priv);\n  return this;\n}\n\nvar primeCache = {};\nfunction checkPrime(prime, generator) {\n  var gen = generator.toString('hex');\n  var hex = [gen, prime.toString(16)].join('_');\n  if (hex in primeCache) {\n    return primeCache[hex];\n  }\n  var error = 0;\n\n  if (prime.isEven() ||\n    !primes.simpleSieve ||\n    !primes.fermatTest(prime) ||\n    !millerRabin.test(prime)) {\n    //not a prime so +1\n    error += 1;\n\n    if (gen === '02' || gen === '05') {\n      // we'd be able to check the generator\n      // it would fail so +8\n      error += 8;\n    } else {\n      //we wouldn't be able to test the generator\n      // so +4\n      error += 4;\n    }\n    primeCache[hex] = error;\n    return error;\n  }\n  if (!millerRabin.test(prime.shrn(1))) {\n    //not a safe prime\n    error += 2;\n  }\n  var rem;\n  switch (gen) {\n    case '02':\n      if (prime.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        // unsuidable generator\n        error += 8;\n      }\n      break;\n    case '05':\n      rem = prime.mod(TEN);\n      if (rem.cmp(THREE) && rem.cmp(SEVEN)) {\n        // prime mod 10 needs to equal 3 or 7\n        error += 8;\n      }\n      break;\n    default:\n      error += 4;\n  }\n  primeCache[hex] = error;\n  return error;\n}\n\nfunction DH(prime, generator, malleable) {\n  this.setGenerator(generator);\n  this.__prime = new BN(prime);\n  this._prime = BN.mont(this.__prime);\n  this._primeLen = prime.length;\n  this._pub = undefined;\n  this._priv = undefined;\n  this._primeCode = undefined;\n  if (malleable) {\n    this.setPublicKey = setPublicKey;\n    this.setPrivateKey = setPrivateKey;\n  } else {\n    this._primeCode = 8;\n  }\n}\nObject.defineProperty(DH.prototype, 'verifyError', {\n  enumerable: true,\n  get: function () {\n    if (typeof this._primeCode !== 'number') {\n      this._primeCode = checkPrime(this.__prime, this.__gen);\n    }\n    return this._primeCode;\n  }\n});\nDH.prototype.generateKeys = function () {\n  if (!this._priv) {\n    this._priv = new BN(randomBytes(this._primeLen));\n  }\n  this._pub = this._gen.toRed(this._prime).redPow(this._priv).fromRed();\n  return this.getPublicKey();\n};\n\nDH.prototype.computeSecret = function (other) {\n  other = new BN(other);\n  other = other.toRed(this._prime);\n  var secret = other.redPow(this._priv).fromRed();\n  var out = new Buffer(secret.toArray());\n  var prime = this.getPrime();\n  if (out.length < prime.length) {\n    var front = new Buffer(prime.length - out.length);\n    front.fill(0);\n    out = Buffer.concat([front, out]);\n  }\n  return out;\n};\n\nDH.prototype.getPublicKey = function getPublicKey(enc) {\n  return formatReturnValue(this._pub, enc);\n};\n\nDH.prototype.getPrivateKey = function getPrivateKey(enc) {\n  return formatReturnValue(this._priv, enc);\n};\n\nDH.prototype.getPrime = function (enc) {\n  return formatReturnValue(this.__prime, enc);\n};\n\nDH.prototype.getGenerator = function (enc) {\n  return formatReturnValue(this._gen, enc);\n};\n\nDH.prototype.setGenerator = function (gen, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(gen)) {\n    gen = new Buffer(gen, enc);\n  }\n  this.__gen = gen;\n  this._gen = new BN(gen);\n  return this;\n};\n\nfunction formatReturnValue(bn, enc) {\n  var buf = new Buffer(bn.toArray());\n  if (!enc) {\n    return buf;\n  } else {\n    return buf.toString(enc);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}