{"ast":null,"code":"// Get the appropriate flag to use for creating files\n// We use fmap on Windows platforms for files less than\n// 512kb.  This is a fairly low limit, but avoids making\n// things slower in some cases.  Since most of what this\n// library is used for is extracting tarballs of many\n// relatively small files in npm packages and the like,\n// it can be a big boost on Windows platforms.\n// Only supported in Node v12.9.0 and above.\nvar platform = process.env.__FAKE_PLATFORM__ || process.platform;\nvar isWindows = platform === 'win32';\nvar fs = global.__FAKE_TESTING_FS__ || require('fs');\n\n/* istanbul ignore next */\nvar _fs$constants = fs.constants,\n  O_CREAT = _fs$constants.O_CREAT,\n  O_TRUNC = _fs$constants.O_TRUNC,\n  O_WRONLY = _fs$constants.O_WRONLY,\n  _fs$constants$UV_FS_O = _fs$constants.UV_FS_O_FILEMAP,\n  UV_FS_O_FILEMAP = _fs$constants$UV_FS_O === void 0 ? 0 : _fs$constants$UV_FS_O;\nvar fMapEnabled = isWindows && !!UV_FS_O_FILEMAP;\nvar fMapLimit = 512 * 1024;\nvar fMapFlag = UV_FS_O_FILEMAP | O_TRUNC | O_CREAT | O_WRONLY;\nmodule.exports = !fMapEnabled ? function () {\n  return 'w';\n} : function (size) {\n  return size < fMapLimit ? fMapFlag : 'w';\n};","map":null,"metadata":{},"sourceType":"script"}