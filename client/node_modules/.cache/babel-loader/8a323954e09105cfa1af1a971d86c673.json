{"ast":null,"code":"var parseKeys = require('parse-asn1');\nvar randomBytes = require('randombytes');\nvar createHash = require('create-hash');\nvar mgf = require('./mgf');\nvar xor = require('./xor');\nvar BN = require('bn.js');\nvar withPublic = require('./withPublic');\nvar crt = require('browserify-rsa');\nvar Buffer = require('safe-buffer').Buffer;\nmodule.exports = function publicEncrypt(publicKey, msg, reverse) {\n  var padding;\n  if (publicKey.padding) {\n    padding = publicKey.padding;\n  } else if (reverse) {\n    padding = 1;\n  } else {\n    padding = 4;\n  }\n  var key = parseKeys(publicKey);\n  var paddedMsg;\n  if (padding === 4) {\n    paddedMsg = oaep(key, msg);\n  } else if (padding === 1) {\n    paddedMsg = pkcs1(key, msg, reverse);\n  } else if (padding === 3) {\n    paddedMsg = new BN(msg);\n    if (paddedMsg.cmp(key.modulus) >= 0) {\n      throw new Error('data too long for modulus');\n    }\n  } else {\n    throw new Error('unknown padding');\n  }\n  if (reverse) {\n    return crt(paddedMsg, key);\n  } else {\n    return withPublic(paddedMsg, key);\n  }\n};\nfunction oaep(key, msg) {\n  var k = key.modulus.byteLength();\n  var mLen = msg.length;\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest();\n  var hLen = iHash.length;\n  var hLen2 = 2 * hLen;\n  if (mLen > k - hLen2 - 2) {\n    throw new Error('message too long');\n  }\n  var ps = Buffer.alloc(k - mLen - hLen2 - 2);\n  var dblen = k - hLen - 1;\n  var seed = randomBytes(hLen);\n  var maskedDb = xor(Buffer.concat([iHash, ps, Buffer.alloc(1, 1), msg], dblen), mgf(seed, dblen));\n  var maskedSeed = xor(seed, mgf(maskedDb, hLen));\n  return new BN(Buffer.concat([Buffer.alloc(1), maskedSeed, maskedDb], k));\n}\nfunction pkcs1(key, msg, reverse) {\n  var mLen = msg.length;\n  var k = key.modulus.byteLength();\n  if (mLen > k - 11) {\n    throw new Error('message too long');\n  }\n  var ps;\n  if (reverse) {\n    ps = Buffer.alloc(k - mLen - 3, 0xff);\n  } else {\n    ps = nonZero(k - mLen - 3);\n  }\n  return new BN(Buffer.concat([Buffer.from([0, reverse ? 1 : 2]), ps, Buffer.alloc(1), msg], k));\n}\nfunction nonZero(len) {\n  var out = Buffer.allocUnsafe(len);\n  var i = 0;\n  var cache = randomBytes(len * 2);\n  var cur = 0;\n  var num;\n  while (i < len) {\n    if (cur === cache.length) {\n      cache = randomBytes(len * 2);\n      cur = 0;\n    }\n    num = cache[cur++];\n    if (num) {\n      out[i++] = num;\n    }\n  }\n  return out;\n}","map":{"version":3,"names":["parseKeys","require","randomBytes","createHash","mgf","xor","BN","withPublic","crt","Buffer","module","exports","publicEncrypt","publicKey","msg","reverse","padding","key","paddedMsg","oaep","pkcs1","cmp","modulus","Error","k","byteLength","mLen","length","iHash","update","alloc","digest","hLen","hLen2","ps","dblen","seed","maskedDb","concat","maskedSeed","nonZero","from","len","out","allocUnsafe","i","cache","cur","num"],"sources":["/Users/admin/Desktop/Newsletter-Signup/Full-Stack-Project-Assessment/client/node_modules/public-encrypt/publicEncrypt.js"],"sourcesContent":["var parseKeys = require('parse-asn1')\nvar randomBytes = require('randombytes')\nvar createHash = require('create-hash')\nvar mgf = require('./mgf')\nvar xor = require('./xor')\nvar BN = require('bn.js')\nvar withPublic = require('./withPublic')\nvar crt = require('browserify-rsa')\nvar Buffer = require('safe-buffer').Buffer\n\nmodule.exports = function publicEncrypt (publicKey, msg, reverse) {\n  var padding\n  if (publicKey.padding) {\n    padding = publicKey.padding\n  } else if (reverse) {\n    padding = 1\n  } else {\n    padding = 4\n  }\n  var key = parseKeys(publicKey)\n  var paddedMsg\n  if (padding === 4) {\n    paddedMsg = oaep(key, msg)\n  } else if (padding === 1) {\n    paddedMsg = pkcs1(key, msg, reverse)\n  } else if (padding === 3) {\n    paddedMsg = new BN(msg)\n    if (paddedMsg.cmp(key.modulus) >= 0) {\n      throw new Error('data too long for modulus')\n    }\n  } else {\n    throw new Error('unknown padding')\n  }\n  if (reverse) {\n    return crt(paddedMsg, key)\n  } else {\n    return withPublic(paddedMsg, key)\n  }\n}\n\nfunction oaep (key, msg) {\n  var k = key.modulus.byteLength()\n  var mLen = msg.length\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest()\n  var hLen = iHash.length\n  var hLen2 = 2 * hLen\n  if (mLen > k - hLen2 - 2) {\n    throw new Error('message too long')\n  }\n  var ps = Buffer.alloc(k - mLen - hLen2 - 2)\n  var dblen = k - hLen - 1\n  var seed = randomBytes(hLen)\n  var maskedDb = xor(Buffer.concat([iHash, ps, Buffer.alloc(1, 1), msg], dblen), mgf(seed, dblen))\n  var maskedSeed = xor(seed, mgf(maskedDb, hLen))\n  return new BN(Buffer.concat([Buffer.alloc(1), maskedSeed, maskedDb], k))\n}\nfunction pkcs1 (key, msg, reverse) {\n  var mLen = msg.length\n  var k = key.modulus.byteLength()\n  if (mLen > k - 11) {\n    throw new Error('message too long')\n  }\n  var ps\n  if (reverse) {\n    ps = Buffer.alloc(k - mLen - 3, 0xff)\n  } else {\n    ps = nonZero(k - mLen - 3)\n  }\n  return new BN(Buffer.concat([Buffer.from([0, reverse ? 1 : 2]), ps, Buffer.alloc(1), msg], k))\n}\nfunction nonZero (len) {\n  var out = Buffer.allocUnsafe(len)\n  var i = 0\n  var cache = randomBytes(len * 2)\n  var cur = 0\n  var num\n  while (i < len) {\n    if (cur === cache.length) {\n      cache = randomBytes(len * 2)\n      cur = 0\n    }\n    num = cache[cur++]\n    if (num) {\n      out[i++] = num\n    }\n  }\n  return out\n}\n"],"mappings":"AAAA,IAAIA,SAAS,GAAGC,OAAO,CAAC,YAAY,CAAC;AACrC,IAAIC,WAAW,GAAGD,OAAO,CAAC,aAAa,CAAC;AACxC,IAAIE,UAAU,GAAGF,OAAO,CAAC,aAAa,CAAC;AACvC,IAAIG,GAAG,GAAGH,OAAO,CAAC,OAAO,CAAC;AAC1B,IAAII,GAAG,GAAGJ,OAAO,CAAC,OAAO,CAAC;AAC1B,IAAIK,EAAE,GAAGL,OAAO,CAAC,OAAO,CAAC;AACzB,IAAIM,UAAU,GAAGN,OAAO,CAAC,cAAc,CAAC;AACxC,IAAIO,GAAG,GAAGP,OAAO,CAAC,gBAAgB,CAAC;AACnC,IAAIQ,MAAM,GAAGR,OAAO,CAAC,aAAa,CAAC,CAACQ,MAAM;AAE1CC,MAAM,CAACC,OAAO,GAAG,SAASC,aAAaA,CAAEC,SAAS,EAAEC,GAAG,EAAEC,OAAO,EAAE;EAChE,IAAIC,OAAO;EACX,IAAIH,SAAS,CAACG,OAAO,EAAE;IACrBA,OAAO,GAAGH,SAAS,CAACG,OAAO;EAC7B,CAAC,MAAM,IAAID,OAAO,EAAE;IAClBC,OAAO,GAAG,CAAC;EACb,CAAC,MAAM;IACLA,OAAO,GAAG,CAAC;EACb;EACA,IAAIC,GAAG,GAAGjB,SAAS,CAACa,SAAS,CAAC;EAC9B,IAAIK,SAAS;EACb,IAAIF,OAAO,KAAK,CAAC,EAAE;IACjBE,SAAS,GAAGC,IAAI,CAACF,GAAG,EAAEH,GAAG,CAAC;EAC5B,CAAC,MAAM,IAAIE,OAAO,KAAK,CAAC,EAAE;IACxBE,SAAS,GAAGE,KAAK,CAACH,GAAG,EAAEH,GAAG,EAAEC,OAAO,CAAC;EACtC,CAAC,MAAM,IAAIC,OAAO,KAAK,CAAC,EAAE;IACxBE,SAAS,GAAG,IAAIZ,EAAE,CAACQ,GAAG,CAAC;IACvB,IAAII,SAAS,CAACG,GAAG,CAACJ,GAAG,CAACK,OAAO,CAAC,IAAI,CAAC,EAAE;MACnC,MAAM,IAAIC,KAAK,CAAC,2BAA2B,CAAC;IAC9C;EACF,CAAC,MAAM;IACL,MAAM,IAAIA,KAAK,CAAC,iBAAiB,CAAC;EACpC;EACA,IAAIR,OAAO,EAAE;IACX,OAAOP,GAAG,CAACU,SAAS,EAAED,GAAG,CAAC;EAC5B,CAAC,MAAM;IACL,OAAOV,UAAU,CAACW,SAAS,EAAED,GAAG,CAAC;EACnC;AACF,CAAC;AAED,SAASE,IAAIA,CAAEF,GAAG,EAAEH,GAAG,EAAE;EACvB,IAAIU,CAAC,GAAGP,GAAG,CAACK,OAAO,CAACG,UAAU,EAAE;EAChC,IAAIC,IAAI,GAAGZ,GAAG,CAACa,MAAM;EACrB,IAAIC,KAAK,GAAGzB,UAAU,CAAC,MAAM,CAAC,CAAC0B,MAAM,CAACpB,MAAM,CAACqB,KAAK,CAAC,CAAC,CAAC,CAAC,CAACC,MAAM,EAAE;EAC/D,IAAIC,IAAI,GAAGJ,KAAK,CAACD,MAAM;EACvB,IAAIM,KAAK,GAAG,CAAC,GAAGD,IAAI;EACpB,IAAIN,IAAI,GAAGF,CAAC,GAAGS,KAAK,GAAG,CAAC,EAAE;IACxB,MAAM,IAAIV,KAAK,CAAC,kBAAkB,CAAC;EACrC;EACA,IAAIW,EAAE,GAAGzB,MAAM,CAACqB,KAAK,CAACN,CAAC,GAAGE,IAAI,GAAGO,KAAK,GAAG,CAAC,CAAC;EAC3C,IAAIE,KAAK,GAAGX,CAAC,GAAGQ,IAAI,GAAG,CAAC;EACxB,IAAII,IAAI,GAAGlC,WAAW,CAAC8B,IAAI,CAAC;EAC5B,IAAIK,QAAQ,GAAGhC,GAAG,CAACI,MAAM,CAAC6B,MAAM,CAAC,CAACV,KAAK,EAAEM,EAAE,EAAEzB,MAAM,CAACqB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAEhB,GAAG,CAAC,EAAEqB,KAAK,CAAC,EAAE/B,GAAG,CAACgC,IAAI,EAAED,KAAK,CAAC,CAAC;EAChG,IAAII,UAAU,GAAGlC,GAAG,CAAC+B,IAAI,EAAEhC,GAAG,CAACiC,QAAQ,EAAEL,IAAI,CAAC,CAAC;EAC/C,OAAO,IAAI1B,EAAE,CAACG,MAAM,CAAC6B,MAAM,CAAC,CAAC7B,MAAM,CAACqB,KAAK,CAAC,CAAC,CAAC,EAAES,UAAU,EAAEF,QAAQ,CAAC,EAAEb,CAAC,CAAC,CAAC;AAC1E;AACA,SAASJ,KAAKA,CAAEH,GAAG,EAAEH,GAAG,EAAEC,OAAO,EAAE;EACjC,IAAIW,IAAI,GAAGZ,GAAG,CAACa,MAAM;EACrB,IAAIH,CAAC,GAAGP,GAAG,CAACK,OAAO,CAACG,UAAU,EAAE;EAChC,IAAIC,IAAI,GAAGF,CAAC,GAAG,EAAE,EAAE;IACjB,MAAM,IAAID,KAAK,CAAC,kBAAkB,CAAC;EACrC;EACA,IAAIW,EAAE;EACN,IAAInB,OAAO,EAAE;IACXmB,EAAE,GAAGzB,MAAM,CAACqB,KAAK,CAACN,CAAC,GAAGE,IAAI,GAAG,CAAC,EAAE,IAAI,CAAC;EACvC,CAAC,MAAM;IACLQ,EAAE,GAAGM,OAAO,CAAChB,CAAC,GAAGE,IAAI,GAAG,CAAC,CAAC;EAC5B;EACA,OAAO,IAAIpB,EAAE,CAACG,MAAM,CAAC6B,MAAM,CAAC,CAAC7B,MAAM,CAACgC,IAAI,CAAC,CAAC,CAAC,EAAE1B,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,EAAEmB,EAAE,EAAEzB,MAAM,CAACqB,KAAK,CAAC,CAAC,CAAC,EAAEhB,GAAG,CAAC,EAAEU,CAAC,CAAC,CAAC;AAChG;AACA,SAASgB,OAAOA,CAAEE,GAAG,EAAE;EACrB,IAAIC,GAAG,GAAGlC,MAAM,CAACmC,WAAW,CAACF,GAAG,CAAC;EACjC,IAAIG,CAAC,GAAG,CAAC;EACT,IAAIC,KAAK,GAAG5C,WAAW,CAACwC,GAAG,GAAG,CAAC,CAAC;EAChC,IAAIK,GAAG,GAAG,CAAC;EACX,IAAIC,GAAG;EACP,OAAOH,CAAC,GAAGH,GAAG,EAAE;IACd,IAAIK,GAAG,KAAKD,KAAK,CAACnB,MAAM,EAAE;MACxBmB,KAAK,GAAG5C,WAAW,CAACwC,GAAG,GAAG,CAAC,CAAC;MAC5BK,GAAG,GAAG,CAAC;IACT;IACAC,GAAG,GAAGF,KAAK,CAACC,GAAG,EAAE,CAAC;IAClB,IAAIC,GAAG,EAAE;MACPL,GAAG,CAACE,CAAC,EAAE,CAAC,GAAGG,GAAG;IAChB;EACF;EACA,OAAOL,GAAG;AACZ"},"metadata":{},"sourceType":"script"}